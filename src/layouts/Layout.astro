---
export interface Props {
  title?: string;
  description?: string;
  image?: string;
  type?: "website" | "article";
}

// Site configuration - centralized site metadata and navigation
const siteConfig = {
  name: "Philomagi.dev",
  tagline: "ソフトウェア、哲学、AC",
  defaultDescription: "Web開発、デザイン、技術記事",
  navigation: [
    {
      label: "Articles",
      href: "/articles",
    },
  ],
  social: [
    {
      label: "GitHub",
      href: "https://github.com/philomagi",
    },
    {
      label: "Twitter",
      href: "https://twitter.com/philomagi",
    },
    {
      label: "Email",
      href: "mailto:tooppoo56@gmail.com",
    },
  ],
} as const;

const {
  title = siteConfig.name,
  description = siteConfig.defaultDescription,
  image = "/og-image.jpg",
  type = "website",
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<!doctype html>
<html lang="ja" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- SEO Meta Tags -->
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph -->
    <meta property="og:type" content={type} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={new URL(image, Astro.url)} />
    <meta property="og:url" content={canonicalURL} />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={new URL(image, Astro.url)} />

    <!-- Favicons -->
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <meta name="generator" content={Astro.generator} />

    <!-- Custom Markdown Styles -->
    <style>
      /* Custom prose styles for Markdown content */
      .prose-primary {
        --tw-prose-body: rgb(229 231 235);
        --tw-prose-headings: rgb(249 250 251);
        --tw-prose-lead: rgb(156 163 175);
        --tw-prose-links: rgb(0 217 255);
        --tw-prose-bold: rgb(0 217 255);
        --tw-prose-counters: rgb(156 163 175);
        --tw-prose-bullets: rgb(107 114 128);
        --tw-prose-hr: rgb(55 65 81);
        --tw-prose-quotes: rgb(229 231 235);
        --tw-prose-quote-borders: rgb(55 65 81);
        --tw-prose-captions: rgb(156 163 175);
        --tw-prose-code: rgb(229 231 235);
        --tw-prose-pre-code: rgb(229 231 235);
        --tw-prose-pre-bg: rgb(17 24 39);
        --tw-prose-th-borders: rgb(55 65 81);
        --tw-prose-td-borders: rgb(55 65 81);
      }

      /* Enhanced heading styles */
      .prose h1 {
        background: linear-gradient(
          135deg,
          rgb(0 217 255) 0%,
          rgb(77 234 255) 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 3.5rem;
        font-weight: 700;
        line-height: 1.1;
        margin-bottom: 2rem;
        margin-top: 0;
      }

      .prose h2 {
        color: rgb(0 217 255);
        font-size: 2.25rem;
        font-weight: 600;
        line-height: 1.2;
        margin-top: 3rem;
        margin-bottom: 1.5rem;
        border-bottom: 2px solid rgb(55 65 81);
        padding-bottom: 0.5rem;
      }

      .prose h3 {
        color: rgb(77 234 255);
        font-size: 1.5rem;
        font-weight: 600;
        line-height: 1.3;
        margin-top: 2rem;
        margin-bottom: 1rem;
      }

      /* Enhanced paragraph and text styles */
      .prose p {
        font-size: 1.125rem;
        line-height: 1.75;
        margin-bottom: 1.5rem;
        color: rgb(229 231 235);
      }

      .prose p:first-child {
        font-size: 1.25rem;
        color: rgb(209 213 219);
        margin-bottom: 2rem;
      }

      /* Enhanced link styles */
      .prose a {
        color: rgb(0 217 255);
        text-decoration: none;
        font-weight: 500;
        transition: all 0.2s ease;
        border-bottom: 1px solid transparent;
      }

      .prose a:hover {
        color: rgb(77 234 255);
        border-bottom-color: rgb(77 234 255);
        text-shadow: 0 0 10px rgba(0, 217, 255, 0.3);
      }

      /* Enhanced list styles */
      .prose ul {
        margin: 1.5rem 0;
        padding-left: 1.5rem;
      }

      .prose li {
        margin: 0.75rem 0;
        line-height: 1.6;
        color: rgb(229 231 235);
      }

      .prose li::marker {
        color: rgb(0 217 255);
      }

      .prose ul > li::before {
        content: "";
        position: absolute;
        background-color: rgb(0 217 255);
        border-radius: 50%;
        width: 0.375rem;
        height: 0.375rem;
        top: calc(0.875rem - 0.1875rem);
        left: 0.25rem;
      }

      /* Strong/bold text enhancement */
      .prose strong {
        color: rgb(0 217 255);
        font-weight: 600;
      }

      /* Code styling */
      .prose code {
        background-color: rgb(31 41 55);
        color: rgb(0 217 255);
        padding: 0.125rem 0.375rem;
        border-radius: 0.25rem;
        font-size: 0.875em;
        font-weight: 500;
      }

      .prose pre {
        background-color: rgb(17 24 39);
        border: 1px solid rgb(55 65 81);
        border-radius: 0.5rem;
        padding: 1.5rem;
        overflow-x: auto;
        margin: 1.5rem 0;
      }

      .prose pre code {
        background-color: transparent;
        padding: 0;
        color: rgb(229 231 235);
      }

      /* Responsive adjustments */
      @media (max-width: 640px) {
        .prose h1 {
          font-size: 2.5rem;
          margin-bottom: 1.5rem;
        }

        .prose h2 {
          font-size: 1.875rem;
          margin-top: 2rem;
          margin-bottom: 1rem;
        }

        .prose h3 {
          font-size: 1.25rem;
          margin-top: 1.5rem;
          margin-bottom: 0.75rem;
        }

        .prose p {
          font-size: 1rem;
        }

        .prose p:first-child {
          font-size: 1.125rem;
        }
      }

      /* Animation enhancements */
      .prose > * {
        animation: fadeIn 0.6s ease-out forwards;
        opacity: 0;
      }

      .prose > *:nth-child(1) {
        animation-delay: 0.1s;
      }
      .prose > *:nth-child(2) {
        animation-delay: 0.2s;
      }
      .prose > *:nth-child(3) {
        animation-delay: 0.3s;
      }
      .prose > *:nth-child(4) {
        animation-delay: 0.4s;
      }
      .prose > *:nth-child(5) {
        animation-delay: 0.5s;
      }
      .prose > *:nth-child(n + 6) {
        animation-delay: 0.6s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>

  <body class="bg-gray-950 text-gray-50 font-sans antialiased min-h-screen">
    <!-- Skip to main content -->
    <a
      href="#main"
      class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary-500 text-gray-950 px-4 py-2 rounded-md z-50 transition-all"
    >
      Skip to main content
    </a>

    <!-- Global Navigation -->
    <header
      class="sticky top-0 z-40 bg-gray-950/80 backdrop-blur-md border-b border-gray-800"
    >
      <nav class="container mx-auto px-4 py-4">
        <div class="flex items-center justify-between">
          <!-- Logo -->
          <a
            href="/"
            class="text-xl font-bold text-primary-500 hover:text-primary-400 transition-colors"
          >
            {siteConfig.name}
          </a>

          <!-- Desktop Navigation -->
          <div class="hidden md:flex items-center space-x-8">
            {siteConfig.navigation.map((item) => (
              <a
                href={item.href}
                class="text-gray-300 hover:text-white transition-colors"
              >
                {item.label}
              </a>
            ))}
          </div>

          <!-- Mobile Menu Button -->
          <button
            class="md:hidden text-gray-300 hover:text-white transition-colors"
            aria-label="Toggle menu"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main id="main" class="flex-1">
      <div class="container mx-auto px-4 py-12 max-w-4xl">
        <article class="prose prose-invert prose-primary max-w-none">
          <slot />
        </article>
      </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-800 py-12 mt-20">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <h3 class="text-lg font-semibold mb-4">{siteConfig.name}</h3>
            <p class="text-gray-400 text-sm">{siteConfig.tagline}</p>
          </div>
          <div>
            <h4 class="font-medium mb-4">Links</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              {siteConfig.navigation.map((item) => (
                <li>
                  <a href={item.href} class="hover:text-white transition-colors">
                    {item.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
          <div>
            <h4 class="font-medium mb-4">Connect</h4>
            <ul class="space-y-2 text-sm text-gray-400">
              {siteConfig.social.map((item) => (
                <li>
                  <a
                    href={item.href}
                    class="hover:text-white transition-colors"
                  >
                    {item.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        </div>
        <div
          class="mt-8 pt-8 border-t border-gray-800 text-center text-sm text-gray-400"
        >
          <p>&copy; 2025 Philomagi. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Add loading animation
        document.body.classList.add("animate-fade-in");

        // Add smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
          anchor.addEventListener("click", function (e: Event) {
            e.preventDefault();
            const element = e.currentTarget as HTMLAnchorElement;
            const target = document.querySelector(
              element.getAttribute("href")!
            );
            if (target) {
              target.scrollIntoView({ behavior: "smooth" });
            }
          });
        });
      });
    </script>
  </body>
</html>
